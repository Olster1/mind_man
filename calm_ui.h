                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    enum element_ui_type {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_Parent,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_Moveable,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_DropDownBoxParent,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_DropDownBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_Slider,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_CheckBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_TextBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_Button,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_Entity
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct enum_array_data  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void* Array;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    char *Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_element;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_element_settings {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 Pos;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 Dim;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //This is for the drop down box parent to say if it is open or not.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 Active;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 ScrollAt; //This value is between 0 & 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //For the text box to retain state across frames
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 CursorIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    char_buffer Buffer;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //For The slider
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 Min;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 Max;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //DropDown data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ActiveChildIndex; //make this null to show if Active?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    char *Name;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    void *ValueLinkedToPtr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s64 ValueLinkedTo;// This is so we no longer have entity pointers, just an ID. It allows the ui elements to hold data and point to it if it needs to store a static reference i.e. an ID... 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    union {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            enum_array_data EnumArray;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char *Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
#define AlterValue(ValueToAlter, Array, Index, type) {*(type *)ValueToAlter = (type)((type *)Array)[Index];}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
#define GetEntityFromElement(UIState) entity *Entity = FindEntityFromID(GameState, CastVoidAs(u32, UIState->InteractingWith->Set.ValueLinkedToPtr));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
#define GetEntityFromElement_(Element) entity *Entity = FindEntityFromID(GameState, CastVoidAs(u32, Element->Set.ValueLinkedToPtr));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_element {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    element_ui_type Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element_settings Set;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // TODO(NAME): This is for looping through the children, Instead of making another type?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 TempChildrenCount; 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *Parent;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ChildrenCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ChildrenIndexes[128];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 IsValid;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_stack_item {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    element_ui_type Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
#define CastValue(Info, type, VarName) type VarName = ((type *)Info->Array)[Info->Index]; 
#define UI_ELEMENT_COUNT 128
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_state {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element Elements[UI_ELEMENT_COUNT];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 FreeElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElementsFree[64];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 StackAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_stack_item StackItems [64]; //Maybe put these on local stack?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *InteractingWith;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *HotEntity;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    entity *EntIntrospecting;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *TempUIStack;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    memory_arena TransientTextBoxArena;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    memory_arena StaticTextBoxArena;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 MouseGrabOffset;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //DEBUG VARIABLES
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 ControlCamera;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    enum_array_data InitInfo;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 GamePaused;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    enum_array_data EditorMode;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //This is to add check point parent chunks to the philsophers search table
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 PhilosopherID;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 CheckPointParentID;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                enum editor_mode {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    NULL_MODE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SELECT_MODE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    INTROSPECT_MODE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CREATE_MODE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    EDIT_CHECKPOINT_CHUNKS_MODE,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal void PopUIElement(ui_state *UIState) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIState->StackAt > 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIState->StackAt--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal u32 AddUIElement_(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElmIndex = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(UIState->FreeElmCount) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ElmIndex = UIState->ElementsFree[--UIState->FreeElmCount];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Assert(UIState->ElmCount < ArrayCount(UIState->Elements));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ElmIndex = UIState->ElmCount++;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *Elm = UIState->Elements + ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    *Elm = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->Set = Settings;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Type == UI_Entity) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Elm->Set.ValueLinkedToPtr = &Elm->Set.ValueLinkedTo;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->Type = Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->Parent= 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->Index = ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->IsValid = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal void PushUIElement__(ui_state *UIState, element_ui_type Type, u32 ElmIndex) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIState->StackAt < ArrayCount(UIState->StackItems));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIState->StackItems[UIState->StackAt++] = {Type, ElmIndex};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal u32 PushUIElement_(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIState->StackAt == 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElementIndex = AddUIElement_(UIState, Type, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushUIElement__(UIState, Type, ElementIndex);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return ElementIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal u32 AddUIElement(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 SingularElement = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(UIState->StackAt == 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        u32 ParentIndex = PushUIElement_(UIState, UI_Parent, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        SingularElement= true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_stack_item *Item = UIState->StackItems + (UIState->StackAt - 1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *Parent = UIState->Elements + Item->Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElmIndex = AddUIElement_(UIState, Type, Settings);UIState->Elements[ElmIndex].Parent = Parent;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(Parent->ChildrenCount < ArrayCount(Parent->ChildrenIndexes));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Parent->ChildrenIndexes[Parent->ChildrenCount++] = ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(SingularElement) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PopUIElement(UIState);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Assert(UIState->StackAt == 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal u32 PushUIElement(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ElmIndex = AddUIElement(UIState, Type, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushUIElement__(UIState, Type, ElmIndex);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal v2i DrawMenuItemWithText(ui_element *Element,render_group *OrthoRenderGroup, v2 *PosAt, font *Font, rect2 *ElementAsRect, rect2 ClipRect,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ui_element *InteractingWith, b32 DrawMenuItem = true) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 ScreenHeight = OrthoRenderGroup->ScreenDim.Y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 ScreenWidth = OrthoRenderGroup->ScreenDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 CheckBoxDim = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Element->Type == UI_CheckBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        CheckBoxDim =  V2i(Font->LineAdvance, Font->LineAdvance);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        v2 CheckBoxCorner = V2(PosAt->X, PosAt->Y);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rect2 CheckBoxRect = Rect2MinDim(CheckBoxCorner, CheckBoxDim);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(Element->Type == UI_CheckBox && (*(b32 *)Element->Set.ValueLinkedToPtr)) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushRect(OrthoRenderGroup, CheckBoxRect, 1, V4(1, 0, 1, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(Element->Type == UI_CheckBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushRectOutline(OrthoRenderGroup, CheckBoxRect, 1, V4(0, 0, 0, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushRect(OrthoRenderGroup, CheckBoxRect, 1, V4(0, 0, 0, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        *ElementAsRect = CheckBoxRect;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PosAt->X += CheckBoxDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    draw_text_options DrawOptions = InitDrawOptions();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DrawOptions.AdvanceYAtStart = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DrawOptions.MaxCursorPos = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DrawOptions.LineAdvanceModifier = 1.2f;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    DrawOptions.DisplayText = DrawMenuItem;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Element->Type == UI_TextBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //DrawOptions.MaxCursorPos = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //DrawOptions.AdvanceYAtStart = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2i CursorAt = TextToOutput(OrthoRenderGroup, Font, Element->Set.Name, PosAt->X, PosAt->Y, ClipRect, V4(0, 0, 0, 1), &DrawOptions);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Element->Type == UI_TextBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char Text[256] = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char *TextStart = Text;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char *At = Text;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char_buffer *ElmBuffer = &Element->Set.Buffer;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        b32 IsActive = (InteractingWith == Element);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(IsActive) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            TextStart = ElmBuffer->Chars;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 NoMatch = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
#define CHECK_STRING_MATCH(TypeToOutput, FormatString) if(DoStringsMatch(Element->Set.Type, #TypeToOutput)) {NoMatch = false; At += PrintS(At, ArrayCount(Text), FormatString, *((TypeToOutput *)Element->Set.ValueLinkedToPtr));}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(u32, "%d");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(s32, "%d");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(r32, "%f");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(b32, "%b");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // We need to search for pointers aswell in the meta generator. 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(char *, "%s");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CHECK_STRING_MATCH(v2, "[%f %f]");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(NoMatch) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                introspect_info NextInfo = FindMetaData(Info->Type);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                OutputInfo();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CopyStringToBuffer(ElmBuffer, Text);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            At += PrintS(At, (u32)(ArrayCount(Text) - (intptr)(At - TextStart)), "\n");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        DrawOptions.MaxCursorPos = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        DrawOptions.AdvanceYAtStart = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        DrawOptions.OptionalLetterCount = ElmBuffer->IndexAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        v2i PrevCursorAt = CursorAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        CursorAt = TextToOutput(OrthoRenderGroup, Font, TextStart, (r32)CursorAt.X, (r32)CursorAt.Y, ClipRect, V4(0, 0, 0, 1), &DrawOptions);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //*ElementAsRect = Rect2MinMax(V2((r32)PrevCursorAt.X, (r32)(PrevCursorAt.Y - Font->LineAdvance)), V2i(CursorAt));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char CharacterAt = ElmBuffer->Chars[ElmBuffer->WriteIndexAt];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        char CharacterAfter = (ElmBuffer->WriteIndexAt + 1 <= ElmBuffer->IndexAt) ? ElmBuffer->Chars[ElmBuffer->WriteIndexAt + 1] : 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(!CharacterAt) { 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            CharacterAt = 'M';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        s32 CursorWidth =  GetCharacterAdvanceFor(Font, CharacterAt, CharacterAfter);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        DrawOptions.DisplayText = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        DrawOptions.OptionalLetterCount = ElmBuffer->WriteIndexAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        v2i DrawCursorAt = TextToOutput(OrthoRenderGroup, Font, TextStart, (r32)PrevCursorAt.X, (r32)PrevCursorAt.Y, ClipRect, V4(0, 0, 0, 1), &DrawOptions);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        rect2 InputCursor = Rect2MinDim(V2i(DrawCursorAt.X, DrawCursorAt.Y - Font->LineAdvance), V2i(CursorWidth, Font->LineAdvance));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        v4 Color1 = V4(0.2f, 0.8f, 0.4f, 1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(IsActive) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PushRect(OrthoRenderGroup, InputCursor, 1, Color1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    rect2 TextRect = Rect2MinMax(*PosAt, V2i(CursorAt));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(DrawMenuItem) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        //PushRectOutline(OrthoRenderGroup, TextRect, 1, V4(0.5f, 1, 0, 1)); 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    switch(Element->Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_CheckBox: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PosAt->X -= CheckBoxDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_TextBox: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *ElementAsRect = TextRect;    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        default: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *ElementAsRect = TextRect;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PosAt->Y = (r32)CursorAt.Y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return CursorAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct ui_loop_info {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ArrayCount; 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 IndexesProcessed[UI_ELEMENT_COUNT];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 PosAt = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *NextHotEntity;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 LastElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *LastElms[64];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r32 MenuWidth;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    v2 StartP;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *ParentElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    //State for the child loop
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *ChildElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ChildAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    u32 ChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 AdvanceChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 LookAtChildren;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                inline ui_loop_info InitUILoopInfo() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_loop_info Info = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info.IndentSpace = 20;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info.MenuWidth = 300;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info.LookAtChildren = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return Info;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                inline void PushOntoLastElms(ui_loop_info *Info, ui_element *ChildElm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(Info->LastElmCount < ArrayCount(Info->LastElms));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_element *NewParentElm = Info->LastElms[Info->LastElmCount++] = ChildElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info->ParentElm = NewParentElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info->ChildAt = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                enum ui_loop_type {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_CHILD_LOOP,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UI_OUTER_LOOP,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                inline void BeginUIElmsLoop(ui_loop_info *UIInfo, ui_state *State, ui_loop_type Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    switch(Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_CHILD_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->AdvanceChildIndex = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->ChildIndex = UIInfo->ParentElm->ChildrenIndexes[UIInfo->ChildAt];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->IndexesProcessed[UIInfo->ChildIndex] = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->ChildElm = State->Elements + UIInfo->ChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->LookAtChildren = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIInfo->ChildElm->IsValid);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_OUTER_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                inline void GetLatestElm(ui_loop_info *UIInfo) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIInfo->LastElmCount > 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo->ParentElm = UIInfo->LastElms[UIInfo->LastElmCount - 1];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                inline b32 EndUIElmsLoop(ui_loop_info *Info, ui_loop_type Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 Break = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    switch(Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_CHILD_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Info->ChildElm->ChildrenCount && Info->LookAtChildren) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->PosAt.X += Info->IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->ParentElm->TempChildrenCount = Info->ChildAt + 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PushOntoLastElms(Info, Info->ChildElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->AdvanceChildIndex = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else if(Info->AdvanceChildIndex) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ++Info->ChildAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        case UI_OUTER_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Info->ParentElm->TempChildrenCount = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Info->LastElmCount > 1) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->PosAt.X -= Info->IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->LastElmCount--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Info->LastElmCount--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // NOTE(Oliver): Finshed rendering whole ui structure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Break = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return Break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal inline void MarkAsDeprecated(ui_state *UIState, ui_element *Elm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Elm->IsValid = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIState->FreeElmCount < ArrayCount(UIState->ElementsFree));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIState->ElementsFree[UIState->FreeElmCount++] = Elm->Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                internal void RemoveUIElmAndChildren(ui_state *UIState, ui_element *ParentUIElm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ui_loop_info UIInfo = InitUILoopInfo();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushOntoLastElms(&UIInfo, ParentUIElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    for(;;) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        GetLatestElm(&UIInfo);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        for(UIInfo.ChildAt = UIInfo.ParentElm->TempChildrenCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo.ChildAt <  UIInfo.ParentElm->ChildrenCount; ) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            BeginUIElmsLoop(&UIInfo, UIState, UI_CHILD_LOOP);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MarkAsDeprecated(UIState, UIInfo.ChildElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            EndUIElmsLoop(&UIInfo, UI_CHILD_LOOP);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if(EndUIElmsLoop(&UIInfo, UI_OUTER_LOOP)) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 MarkAsDeprecated(UIState, ParentUIElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                        inline void ClearIntrospectWindow(ui_state *UIState) {
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                            if(UIState->TempUIStack) {
                                                                                                                                                                                                                                                                                RemoveUIElmAndChildren(UIState,UIState->TempUIStack);
                                                                                                                                                                                                                                                                                EmptyMemoryArena(&UIState->TransientTextBoxArena);
                                                                                                                                                                                                                                                                                UIState->TempUIStack = 0;
                                                                                                                                                                                                                                                                                UIState->EntIntrospecting = 0;
                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                