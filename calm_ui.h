                                                                                                                                                                                                                                                                                                                                                                                                                                                                            enum element_ui_type {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_Parent,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_Moveable,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_DropDownBoxParent,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_DropDownBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_Slider,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_CheckBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_TextBox,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_Button,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_Entity
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct enum_array_data  {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            void* Array;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            char *Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_element;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_element_settings {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2 Pos;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2 Dim;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //This is for the drop down box parent to say if it is open or not.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 Active;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 ScrollAt; //This value is between 0 & 1
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //For the text box to retain state across frames
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 CursorIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            char_buffer Buffer;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //For The slider
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 Min;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 Max;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //DropDown data
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ActiveChildIndex; //make this null to show if Active?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            char *Name;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            void *ValueLinkedToPtr;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s64 ValueLinkedTo;// This is so we no longer have entity pointers, just an ID. It allows the ui elements to hold data and point to it if it needs to store a static reference i.e. an ID... 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            union {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                struct {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    enum_array_data EnumArray;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
#define AlterValue(ValueToAlter, Array, Index, type) {*(type *)ValueToAlter = (type)((type *)Array)[Index];}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
#define GetEntityFromElement(UIState) entity *Entity = FindEntityFromID(GameState, CastVoidAs(u32, UIState->InteractingWith->Set.ValueLinkedToPtr));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
#define GetEntityFromElement_(Element) entity *Entity = FindEntityFromID(GameState, CastVoidAs(u32, Element->Set.ValueLinkedToPtr));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_element {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            element_ui_type Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element_settings Set;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // TODO(NAME): This is for looping through the children, Instead of making another type?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 TempChildrenCount; 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *Parent;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ChildrenCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ChildrenIndexes[128];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 IsValid;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_stack_item {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            element_ui_type Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
#define CastValue(Info, type) type Value = ((type *)Info->Array)[Info->Index]; 
#define UI_ELEMENT_COUNT 128
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_state {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element Elements[UI_ELEMENT_COUNT];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 FreeElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElementsFree[64];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 StackAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_stack_item StackItems [64]; //Maybe put these on local stack?
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *InteractingWith;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *HotEntity;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *TempUIStack;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            memory_arena TempArena;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 LastCheckPointParentID;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //DEBUG VARIABLES
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 ControlCamera;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            enum_array_data InitInfo;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 GamePaused;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal void PopUIElement(ui_state *UIState) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIState->StackAt > 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIState->StackAt--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal u32 AddUIElement_(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElmIndex = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(UIState->FreeElmCount) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ElmIndex = UIState->ElementsFree[--UIState->FreeElmCount];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Assert(UIState->ElmCount < ArrayCount(UIState->Elements));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ElmIndex = UIState->ElmCount++;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *Elm = UIState->Elements + ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            *Elm = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->Set = Settings;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Type == UI_Entity) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Elm->Set.ValueLinkedToPtr = &Elm->Set.ValueLinkedTo;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->Type = Type;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->Parent= 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->Index = ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->IsValid = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal void PushUIElement__(ui_state *UIState, element_ui_type Type, u32 ElmIndex) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIState->StackAt < ArrayCount(UIState->StackItems));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIState->StackItems[UIState->StackAt++] = {Type, ElmIndex};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal u32 PushUIElement_(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIState->StackAt == 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElementIndex = AddUIElement_(UIState, Type, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushUIElement__(UIState, Type, ElementIndex);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return ElementIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal u32 AddUIElement(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 SingularElement = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(UIState->StackAt == 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                u32 ParentIndex = PushUIElement_(UIState, UI_Parent, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                SingularElement= true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_stack_item *Item = UIState->StackItems + (UIState->StackAt - 1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *Parent = UIState->Elements + Item->Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElmIndex = AddUIElement_(UIState, Type, Settings);UIState->Elements[ElmIndex].Parent = Parent;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(Parent->ChildrenCount < ArrayCount(Parent->ChildrenIndexes));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Parent->ChildrenIndexes[Parent->ChildrenCount++] = ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(SingularElement) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PopUIElement(UIState);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Assert(UIState->StackAt == 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal u32 PushUIElement(ui_state *UIState, element_ui_type Type, ui_element_settings Settings) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ElmIndex = AddUIElement(UIState, Type, Settings);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushUIElement__(UIState, Type, ElmIndex);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return ElmIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal v2i DrawMenuItemWithText(ui_element *Element,render_group *OrthoRenderGroup, v2 *PosAt, font *Font, rect2 *ElementAsRect, rect2 ClipRect,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ui_element *InteractingWith, b32 DrawMenuItem = true) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 ScreenHeight = OrthoRenderGroup->ScreenDim.Y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 ScreenWidth = OrthoRenderGroup->ScreenDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2 CheckBoxDim = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Element->Type == UI_CheckBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                CheckBoxDim =  V2i(Font->LineAdvance, Font->LineAdvance);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                v2 CheckBoxCorner = V2(PosAt->X, PosAt->Y);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                rect2 CheckBoxRect = Rect2MinDim(CheckBoxCorner, CheckBoxDim);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if(Element->Type == UI_CheckBox && (*(b32 *)Element->Set.ValueLinkedToPtr)) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushRect(OrthoRenderGroup, CheckBoxRect, 1, V4(1, 0, 1, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if(Element->Type == UI_CheckBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushRectOutline(OrthoRenderGroup, CheckBoxRect, 1, V4(0, 0, 0, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    PushRect(OrthoRenderGroup, CheckBoxRect, 1, V4(0, 0, 0, 1));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *ElementAsRect = CheckBoxRect;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PosAt->X += CheckBoxDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            draw_text_options DrawOptions = InitDrawOptions();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            DrawOptions.AdvanceYAtStart = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            DrawOptions.MaxCursorPos = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            DrawOptions.LineAdvanceModifier = 1.2f;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            DrawOptions.DisplayText = DrawMenuItem;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2i CursorAt = TextToOutput(OrthoRenderGroup, Font, Element->Set.Name, PosAt->X, PosAt->Y, ClipRect, V4(0, 0, 0, 1), &DrawOptions);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Element->Type == UI_TextBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char Text[256] = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                char *At = Text;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if(InteractingWith == Element) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    At = Element->Set.Buffer.Chars;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    b32 NoMatch = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
#define CHECK_STRING_MATCH(TypeToOutput, PrintString) if(DoStringsMatch(Element->Set.Type, #TypeToOutput)) {NoMatch = false; PrintS(At, ArrayCount(Text), PrintString,*((TypeToOutput *)Element->Set.ValueLinkedToPtr)); }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    AddToOutBuffer("%s \n", Element->Set.Type);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(u32, " %d");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(s32, " %d");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(r32, " %f");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(b32, " %b");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(char, " %s");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CHECK_STRING_MATCH(v2, " [%f %f]");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(NoMatch) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        introspect_info NextInfo = FindMetaData(Info->Type);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        OutputInfo();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        */
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    CopyStringToBuffer(Element->Set.Buffer.Chars, Element->Set.Buffer.Count, Text);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                DrawOptions.AdvanceYAtStart = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                CursorAt = TextToOutput(OrthoRenderGroup, Font, At, (r32)CursorAt.X, (r32)CursorAt.Y, ClipRect, V4(0, 0, 0, 1), &DrawOptions);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            rect2 TextRect = Rect2MinMax(*PosAt, V2i(CursorAt));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(DrawMenuItem) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                //PushRectOutline(OrthoRenderGroup, TextRect, 1, V4(0.5f, 1, 0, 1)); 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(Element->Type != UI_CheckBox) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *ElementAsRect = TextRect;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                PosAt->X -= CheckBoxDim.X;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PosAt->Y = (r32)CursorAt.Y;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return CursorAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        struct ui_loop_info {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ArrayCount; 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 IndexesProcessed[UI_ELEMENT_COUNT];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2 PosAt = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *NextHotEntity;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 LastElmCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *LastElms[64];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            r32 MenuWidth;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            v2 StartP;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *ParentElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            //State for the child loop
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *ChildElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ChildAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            u32 ChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 AdvanceChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        inline ui_loop_info InitUILoopInfo() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_loop_info Info = {};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Info.IndentSpace = 20;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Info.MenuWidth = 300;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return Info;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        inline void PushOntoLastElms(ui_loop_info *Info, ui_element *ChildElm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(Info->LastElmCount < ArrayCount(Info->LastElms));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_element *NewParentElm = Info->LastElms[Info->LastElmCount++] = ChildElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Info->ParentElm = NewParentElm;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        enum ui_loop_type {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_CHILD_LOOP,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UI_OUTER_LOOP,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        inline void BeginUIElmsLoop(ui_loop_info *UIInfo, ui_state *State, ui_loop_type Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            switch(Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                case UI_CHILD_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo->AdvanceChildIndex = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo->ChildIndex = UIInfo->ParentElm->ChildrenIndexes[UIInfo->ChildAt];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo->IndexesProcessed[UIInfo->ChildIndex] = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo->ChildElm = State->Elements + UIInfo->ChildIndex;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Assert(UIInfo->ChildElm->IsValid);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                case UI_OUTER_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        inline void GetLatestElm(ui_loop_info *UIInfo) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIInfo->LastElmCount > 0);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIInfo->ParentElm = UIInfo->LastElms[UIInfo->LastElmCount - 1];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        inline b32 EndUIElmsLoop(ui_loop_info *Info, ui_loop_type Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            b32 Break = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            switch(Type) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                case UI_CHILD_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Info->ChildElm->ChildrenCount) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->PosAt.X += Info->IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->ParentElm->TempChildrenCount = Info->ChildAt + 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        PushOntoLastElms(Info, Info->ChildElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->AdvanceChildIndex = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Info->AdvanceChildIndex) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ++Info->ChildAt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                case UI_OUTER_LOOP: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Info->ParentElm->TempChildrenCount = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if(Info->LastElmCount > 1) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->PosAt.X -= Info->IndentSpace;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->LastElmCount--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Info->LastElmCount--;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // NOTE(Oliver): Finshed rendering whole ui structure
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Break = true;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return Break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal inline void MarkAsDeprecated(ui_state *UIState, ui_element *Elm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Elm->IsValid = false;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Assert(UIState->FreeElmCount < ArrayCount(UIState->ElementsFree));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            UIState->ElementsFree[UIState->FreeElmCount++] = Elm->Index;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        internal void RemoveUIElmAndChildren(ui_state *UIState, ui_element *ParentUIElm) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ui_loop_info UIInfo = InitUILoopInfo();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            PushOntoLastElms(&UIInfo, ParentUIElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            for(;;) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                GetLatestElm(&UIInfo);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                for(UIInfo.ChildAt = UIInfo.ParentElm->TempChildrenCount;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    UIInfo.ChildAt <  UIInfo.ParentElm->ChildrenCount; ) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    BeginUIElmsLoop(&UIInfo, UIState, UI_CHILD_LOOP);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    MarkAsDeprecated(UIState, UIInfo.ChildElm);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    EndUIElmsLoop(&UIInfo, UI_CHILD_LOOP);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if(EndUIElmsLoop(&UIInfo, UI_OUTER_LOOP)) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    break;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            MarkAsDeprecated(UIState, ParentUIElm);
                                                                                                                                                                                                                                                                        } 